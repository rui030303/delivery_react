{"ast":null,"code":"import _regeneratorRuntime from\"D:/github/delivery/delivery_react/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"D:/github/delivery/delivery_react/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";//编写store\nimport{createSlice}from\"@reduxjs/toolkit\";import axios from\"axios\";var foodsStore=createSlice({name:'foods',initialState:{foodsList:[],activeIndex:0,cartList:[]},reducers:{setFoodsList:function setFoodsList(state,action){state.foodsList=action.payload;},changeActiveIndex:function changeActiveIndex(state,action){state.activeIndex=action.payload;},addCart:function addCart(state,action){var item=state.cartList.find(function(item){return item.id===action.payload.id;});if(item){item.count++;console.log(item.count);}else{state.cartList.push(action.payload);}},increCount:function increCount(state,action){var item=state.cartList.find(function(item){return item.id===action.payload.id;});item.count++;},decreCount:function decreCount(state,action){var item=state.cartList.find(function(item){return item.id===action.payload.id;});if(item.count===0){return;}item.count--;},clearCart:function clearCart(state){state.cartList=[];}}});var _foodsStore$actions=foodsStore.actions,setFoodsList=_foodsStore$actions.setFoodsList,changeActiveIndex=_foodsStore$actions.changeActiveIndex,addCart=_foodsStore$actions.addCart,increCount=_foodsStore$actions.increCount,decreCount=_foodsStore$actions.decreCount,clearCart=_foodsStore$actions.clearCart;var fetchFoodsList=function fetchFoodsList(){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(dispatch){var res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get('http://localhost:3004/takeaway');case 2:res=_context.sent;dispatch(setFoodsList(res.data));case 4:case\"end\":return _context.stop();}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};export{fetchFoodsList,changeActiveIndex,addCart,increCount,decreCount,clearCart};var reducer=foodsStore.reducer;export default reducer;","map":{"version":3,"names":["createSlice","axios","foodsStore","name","initialState","foodsList","activeIndex","cartList","reducers","setFoodsList","state","action","payload","changeActiveIndex","addCart","item","find","id","count","console","log","push","increCount","decreCount","clearCart","actions","fetchFoodsList","dispatch","get","res","data","reducer"],"sources":["D:/github/delivery/delivery_react/src/store/modules/takeaway.js"],"sourcesContent":["//编写store\r\n\r\nimport {createSlice} from \"@reduxjs/toolkit\"\r\nimport axios from \"axios\"\r\nconst foodsStore = createSlice({\r\n    name:'foods',\r\n    initialState:{\r\n        foodsList:[],\r\n        activeIndex : 0,\r\n        cartList : []\r\n    },\r\n    reducers:{\r\n        setFoodsList(state, action){\r\n            state.foodsList = action.payload\r\n        },\r\n        changeActiveIndex(state, action){\r\n            state.activeIndex = action.payload\r\n        },\r\n        addCart(state, action){\r\n            const item = state.cartList.find(item => item.id === action.payload.id)\r\n            if (item){\r\n                item.count++\r\n                console.log(item.count);\r\n            }else{\r\n                state.cartList.push(action.payload)\r\n            }\r\n        },\r\n        increCount (state, action) {\r\n            const item = state.cartList.find(item => item.id === action.payload.id)\r\n            item.count++\r\n        },\r\n        decreCount (state, action) {\r\n            const item = state.cartList.find(item => item.id === action.payload.id)\r\n            if (item.count === 0 ){\r\n                return \r\n            }\r\n            item.count--\r\n        },\r\n        clearCart(state){\r\n            state.cartList = []\r\n        }\r\n    }\r\n})\r\nconst {setFoodsList,changeActiveIndex, addCart,increCount, decreCount,clearCart} = foodsStore.actions\r\nconst fetchFoodsList = ()=>{\r\n    return async(dispatch)=>{\r\n        const res = await axios.get('http://localhost:3004/takeaway')\r\n        dispatch(setFoodsList(res.data))\r\n    }\r\n}\r\nexport {fetchFoodsList,changeActiveIndex, addCart,increCount, decreCount,clearCart}\r\nconst reducer = foodsStore.reducer\r\nexport default reducer"],"mappings":"8PAAA;AAEA,OAAQA,WAAW,KAAO,kBAAkB,CAC5C,MAAOC,MAAK,KAAM,OAAO,CACzB,GAAMC,WAAU,CAAGF,WAAW,CAAC,CAC3BG,IAAI,CAAC,OAAO,CACZC,YAAY,CAAC,CACTC,SAAS,CAAC,EAAE,CACZC,WAAW,CAAG,CAAC,CACfC,QAAQ,CAAG,EACf,CAAC,CACDC,QAAQ,CAAC,CACLC,YAAY,uBAACC,KAAK,CAAEC,MAAM,CAAC,CACvBD,KAAK,CAACL,SAAS,CAAGM,MAAM,CAACC,OAAO,CACpC,CAAC,CACDC,iBAAiB,4BAACH,KAAK,CAAEC,MAAM,CAAC,CAC5BD,KAAK,CAACJ,WAAW,CAAGK,MAAM,CAACC,OAAO,CACtC,CAAC,CACDE,OAAO,kBAACJ,KAAK,CAAEC,MAAM,CAAC,CAClB,GAAMI,KAAI,CAAGL,KAAK,CAACH,QAAQ,CAACS,IAAI,CAAC,SAAAD,IAAI,QAAIA,KAAI,CAACE,EAAE,GAAKN,MAAM,CAACC,OAAO,CAACK,EAAE,GAAC,CACvE,GAAIF,IAAI,CAAC,CACLA,IAAI,CAACG,KAAK,EAAE,CACZC,OAAO,CAACC,GAAG,CAACL,IAAI,CAACG,KAAK,CAAC,CAC3B,CAAC,IAAI,CACDR,KAAK,CAACH,QAAQ,CAACc,IAAI,CAACV,MAAM,CAACC,OAAO,CAAC,CACvC,CACJ,CAAC,CACDU,UAAU,qBAAEZ,KAAK,CAAEC,MAAM,CAAE,CACvB,GAAMI,KAAI,CAAGL,KAAK,CAACH,QAAQ,CAACS,IAAI,CAAC,SAAAD,IAAI,QAAIA,KAAI,CAACE,EAAE,GAAKN,MAAM,CAACC,OAAO,CAACK,EAAE,GAAC,CACvEF,IAAI,CAACG,KAAK,EAAE,CAChB,CAAC,CACDK,UAAU,qBAAEb,KAAK,CAAEC,MAAM,CAAE,CACvB,GAAMI,KAAI,CAAGL,KAAK,CAACH,QAAQ,CAACS,IAAI,CAAC,SAAAD,IAAI,QAAIA,KAAI,CAACE,EAAE,GAAKN,MAAM,CAACC,OAAO,CAACK,EAAE,GAAC,CACvE,GAAIF,IAAI,CAACG,KAAK,GAAK,CAAC,CAAE,CAClB,OACJ,CACAH,IAAI,CAACG,KAAK,EAAE,CAChB,CAAC,CACDM,SAAS,oBAACd,KAAK,CAAC,CACZA,KAAK,CAACH,QAAQ,CAAG,EAAE,CACvB,CACJ,CACJ,CAAC,CAAC,CACF,wBAAmFL,UAAU,CAACuB,OAAO,CAA9FhB,YAAY,qBAAZA,YAAY,CAACI,iBAAiB,qBAAjBA,iBAAiB,CAAEC,OAAO,qBAAPA,OAAO,CAACQ,UAAU,qBAAVA,UAAU,CAAEC,UAAU,qBAAVA,UAAU,CAACC,SAAS,qBAATA,SAAS,CAC/E,GAAME,eAAc,CAAG,QAAjBA,eAAc,EAAO,CACvB,iGAAO,iBAAMC,QAAQ,iJACC1B,MAAK,CAAC2B,GAAG,CAAC,gCAAgC,CAAC,QAAvDC,GAAG,eACTF,QAAQ,CAAClB,YAAY,CAACoB,GAAG,CAACC,IAAI,CAAC,CAAC,sDACnC,+DACL,CAAC,CACD,OAAQJ,cAAc,CAACb,iBAAiB,CAAEC,OAAO,CAACQ,UAAU,CAAEC,UAAU,CAACC,SAAS,EAClF,GAAMO,QAAO,CAAG7B,UAAU,CAAC6B,OAAO,CAClC,cAAeA,QAAO"},"metadata":{},"sourceType":"module","externalDependencies":[]}